---
title: 机器学习开放课程：四、线性分类与线性回归
date: 2018-10-29 08:38:25
updated: 2018-10-26
tags:
 - 编程
 - Python
 - 机器学习
 - 稀疏矩阵
categories:
 - 编程
 - Python
 - 机器学习
typora-root-url: 机器学习开放课程：四、线性分类与线性回归
mathjax: true
description: <!—more—->
---

##### [稀疏/稠密矩阵](https://zh.wikipedia.org/wiki/%E7%A8%80%E7%96%8F%E7%9F%A9%E9%98%B5)

{% blockquote 稀疏矩阵 https://zh.wikipedia.org/wiki/%E7%A8%80%E7%96%8F%E7%9F%A9%E9%98%B5 %}

在数值分析中，**稀疏**矩阵（Sparse matrix），是其元素大部分为零的矩阵。反之，如果大部分元素都非零，则这个矩阵是**稠密**的。在科学与工程领域中求解线性模型时经常出现大型的稀疏矩阵。

在使用计算机存储和操作稀疏矩阵时，经常需要修改标准算法以利用矩阵的稀疏结构。由于其自身的稀疏特性，通过压缩可以大大节省稀疏矩阵的内存代价。更为重要的是，由于过大的尺寸，标准的算法经常无法操作这些稀疏矩阵。

{% endblockquote %}

###### [scipy.sparse.csr_matrix](https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html)

```python
>>> indptr = np.array([0, 2, 3, 6])
>>> indices = np.array([0, 2, 2, 0, 1, 2])
>>> data = np.array([1, 2, 3, 4, 5, 6])
>>> csr_matrix((data, indices, indptr), shape=(3, 3)).toarray()
array([[1, 0, 2],
       [0, 0, 3],
       [4, 5, 6]])
```

网上找了好久终于理解了是如何计算的...

![](TIM20181031095548.png)

```python
>>> row = np.array([0, 0, 1, 2, 2, 2])
>>> col = np.array([0, 2, 2, 0, 1, 2])
>>> data = np.array([1, 2, 3, 4, 5, 6])
>>> csr_matrix((data, (row, col)), shape=(3, 3)).toarray()
array([[1, 0, 2],
       [0, 0, 3],
       [4, 5, 6]])
```

这个方法更好理解一些。直接根据对应的行列带入就好了。

>  比如说 `data[2]=3`对应 `col[2]=2,row[2]=1` 说明了它的位置应该在第1行的第2列（数组从0开始）。

![](TIM20181031100050.png)



矩阵的稀疏性可以用一个得分来量化，也就是矩阵中零值的个数除以矩阵中元素的总个数。

$$ 稀疏性 = \frac{0元素总数}{元素总数}$$

```python
from scipy.sparse import csr_matrix
from numpy import count_nonzero

# 创建一维数据，包含9个数据
data = [1] * 9
indices = [1, 0, 0, 1, 3, 1, 2, 3, 4]
indptr = [0, 3, 6, 9]
# 压缩稀疏行矩阵
# indices[1]和indices[2]均指向第0行的第0列，所以矩阵中结果为2。第1行第1列也是一样
# [[2 1 0 0 0]
#  [0 2 0 1 0]
#  [0 0 1 1 1]]
small_example = csr_matrix((data, indices, indptr)).toarray()
# 将矩阵转换为一维
# [2 1 0 0 0 0 2 0 1 0 0 0 1 1 1]
small_example_flatten = small_example.flatten()
# 元素总数
# 15
total = small_example_flatten.shape[0]
# 0元素数量
# 7
none_count = count_nonzero(small_example_flatten)
# 矩阵的稀疏性
# 0.5333333333333333
sparsity = 1.0 - none_count / total

```

使用 `numpy` 在 **稀疏矩阵** 和 **稠密矩阵** 间转换。

```python
from scipy.sparse import csr_matrix

arr = [[1, 0, 0], [0, 1, 0], [0, 0, 1]]
# 创建稠密矩阵
# (0, 0)	1
# (1, 1)	1
# (2, 2)	1
matrix = csr_matrix(arr)
# 返回此矩阵的密集ndarray表示
# [[1 0 0]
# [0 1 0]
# [0 0 1]]
matrix.toarray()

```

###### 



# 待处理

- [] 逻辑回归
- [] StandardScalers数据预处理
- [] Matrix的Sum
- [] np.logspace
- [] tqdm
- [] np.argmax
- [] LogisticRegression
- [] plt.axhline
- [] hstack
- [] 学习如何使用稀疏矩阵，训练逻辑回归模型，创建新特征并选择最佳特征